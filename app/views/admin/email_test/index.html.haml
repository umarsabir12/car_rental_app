.container.mx-auto.max-w-4xl.p-8
  .bg-white.rounded-2xl.shadow-xl.p-8
    %h1.text-2xl.font-bold.text-blue-900.mb-4 Email Service Test
    %p.text-gray-700.mb-6 Test your SendGrid email configuration by sending a test email.

    - if flash[:notice]
      .mb-6.p-4.bg-green-100.border-l-4.border-green-500.rounded.text-green-700.font-semibold= flash[:notice]
    
    - if flash[:alert]
      .mb-6.p-4.bg-red-100.border-l-4.border-red-500.rounded.text-red-700.font-semibold= flash[:alert]

    .bg-blue-50.border.border-blue-200.rounded-lg.p-6.mb-6
      %h3.text-lg.font-semibold.text-blue-800.mb-3 SendGrid Configuration Status
      .grid.grid-cols-1.md:grid-cols-2.gap-4
        .flex.items-center.gap-2
          - if ENV['SENDGRID_API_KEY'].present?
            %i.fas.fa-check-circle.text-green-500
            %span.text-green-700.font-medium API Key: Configured
          - else
            %i.fas.fa-times-circle.text-red-500
            %span.text-red-700.font-medium API Key: Not Set
        .flex.items-center.gap-2
          - if ENV['FROM_EMAIL'].present?
            %i.fas.fa-check-circle.text-green-500
            %span.text-green-700.font-medium From Email: #{ENV['FROM_EMAIL']}
          - else
            %i.fas.fa-info-circle.text-blue-500
            %span.text-blue-700.font-medium From Email: Using default

    = form_with url: admin_email_test_send_test_path, method: :post, local: true, class: 'space-y-4' do |f|
      .form-group
        = f.label :email, 'Test Email Address', class: 'block text-sm font-medium text-gray-700 mb-2'
        = f.email_field :email, placeholder: 'Enter email address to test', class: 'w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500', required: true
      
      .form-group
        = f.submit 'Send Test Email', class: 'bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition-colors'

    .mt-8.bg-gray-50.border.border-gray-200.rounded-lg.p-6
      %h3.text-lg.font-semibold.text-gray-800.mb-3 Setup Instructions
      %ol.list-decimal.list-inside.space-y-2.text-sm.text-gray-700
        %li Create a free SendGrid account at sendgrid.com
        %li Generate an API key in SendGrid dashboard
        %li Set the API key: 
          %code.bg-gray-200.px-2.py-1.rounded.text-xs heroku config:set SENDGRID_API_KEY=your_api_key_here
        %li Optionally set a custom from email:
          %code.bg-gray-200.px-2.py-1.rounded.text-xs heroku config:set FROM_EMAIL=noreply@yourdomain.com
        %li Deploy your application: 
          %code.bg-gray-200.px-2.py-1.rounded.text-xs git push heroku main
        %li Test email sending using the form above
