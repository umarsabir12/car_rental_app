-# Admin Document Show Page
.container.mx-auto.px-4.py-8
  .bg-white.shadow-lg.rounded-xl.overflow-hidden.p-8.flex.flex-col.md:flex-row.gap-10.w-full.max-w-full
    / Image Preview Modal
    %div#image-preview-modal.fixed.inset-0.z-50.flex.items-center.justify-center.bg-black.bg-opacity-70.hidden
      .bg-white.rounded-2xl.shadow-2xl.p-10.flex.flex-col.items-center.max-w-6xl.w-full.mx-4
        %img#preview-img.max-h-90.w-auto.object-contain.rounded-2xl.mb-6{ src: '', alt: 'Preview' }
        %button.mt-2.bg-gray-700.text-white.px-6.py-2.rounded-lg.font-bold.hover:bg-gray-900.w-full.transition{ onclick: "closeImagePreview()" } Close

    / Left: User Details
    .flex-1.max-w-xs.rounded-xl.p-6.flex.flex-col.shadow-md
      %i.fas.fa-user-circle.text-5xl.text-blue-300.mb-3
      %h2.text-xl.font-bold.text-blue-900.mb-1= @user.full_name.presence || @user.email
      %div.text-gray-600.mb-1= @user.email
      %div.text-gray-500.mb-1= @user.phone
      = link_to 'View User', admin_customer_path(@user), class: 'mt-4 inline-block bg-blue-100 text-blue-800 font-semibold px-4 py-1 rounded-lg hover:bg-blue-200 transition'
    / Right: Document Details
    .flex-2.w-full.min-h-800
      %h1.text-2xl.font-bold.text-blue-900.mb-4= @document.doc_name
      %div.text-gray-600.mb-2
        -# %span.font-semibold Type:
        -# = @document.document_type.titleize
      %div.text-gray-600.mb-2
        -# %span.font-semibold Status:
        -# %span.font-semibold.ml-1= @document.status.titleize
      - if @document.images.attached?
        .flex.flex-wrap.gap-6.mb-6.justify-start
          - @document.images.each do |img|
            %img.w-80.h-60.object-cover.rounded-2xl.shadow-lg.cursor-pointer{ src: url_for(img), alt: @document.doc_name, onclick: "openImagePreview('#{url_for(img)}')" }
      - if @document.status == 'rejected' && @document.reason.present?
        %div.text-red-600.mb-2
          %span.font-semibold Reason:
          = @document.reason
      .flex.gap-4.mt-6
        - unless @document.status == 'approved'
          = form_with url: approve_admin_document_path(@document), method: :patch, local: true, class: 'inline' do |f|
            = f.submit 'Approve', class: 'border border-green-600 text-green-700 bg-transparent px-6 py-2 rounded-lg font-bold hover:bg-green-50 transition cursor-pointer'
        - unless @document.status == 'rejected'
          %button#reject-btn.border.border-red-600.text-red-700.bg-transparent.px-6.py-2.rounded-lg.font-bold.hover:bg-red-50.transition{ type: 'button', onclick: 'showRejectForm()' } Reject

= form_with url: reject_admin_document_path(@document), method: :post, local: true, html: { id: 'reject-form', class: 'hidden mt-4 flex flex-col items-center', style: 'width: 100%;' } do |f|
  %label.text-sm.font-semibold.text-gray-700.mb-2 Reason for rejection
  = f.text_area :reason, class: 'block w-full p-3 border border-gray-300 rounded-lg mb-3', rows: 3, placeholder: 'Enter reason...'
  = f.submit 'Submit', class: 'border border-red-600 text-red-700 bg-transparent px-6 py-2 rounded-lg font-bold hover:bg-red-50 transition'

:javascript
  function openImagePreview(src) {
    var modal = document.getElementById('image-preview-modal');
    var img = document.getElementById('preview-img');
    img.src = src;
    modal.classList.remove('hidden');
  }
  function closeImagePreview() {
    var modal = document.getElementById('image-preview-modal');
    var img = document.getElementById('preview-img');
    img.src = '';
    modal.classList.add('hidden');
  }
  function showRejectForm() {
    document.getElementById('reject-form').classList.remove('hidden');
  } 