.container-fluid.px-4.py-8
  = render partial: "vendors/navbar"
  .bg-white.shadow-lg.rounded-xl.overflow-hidden.p-8.mt-5
    / Header Section
    .mb-6
      %h1.text-3xl.font-extrabold{style: 'color: #3A6363'} My Invoices
      %p.text-gray-600.mt-1 View and track all your invoices

    / Summary Cards
    .grid.grid-cols-1.md:grid-cols-3.gap-4.mb-6
      .bg-gradient-to-r.from-blue-50.to-blue-100.rounded-lg.p-4.border.border-blue-200
        .flex.items-center.justify-between
          %div
            %p.text-sm.font-semibold.text-blue-600.uppercase Total Invoices
            %p.text-3xl.font-bold.text-blue-900= current_vendor.invoices.count
          %i.fas.fa-file-invoice.text-4xl.text-blue-300

      .bg-gradient-to-r.from-amber-50.to-amber-100.rounded-lg.p-4.border.border-amber-200
        .flex.items-center.justify-between
          %div
            %p.text-sm.font-semibold.text-amber-600.uppercase Pending Amount
            %p.text-3xl.font-bold.text-amber-900= number_to_currency(current_vendor.total_pending_amount)
          %i.fas.fa-clock.text-4xl.text-amber-300

      .bg-gradient-to-r.from-emerald-50.to-emerald-100.rounded-lg.p-4.border.border-emerald-200
        .flex.items-center.justify-between
          %div
            %p.text-sm.font-semibold.text-emerald-600.uppercase Paid Amount
            %p.text-3xl.font-bold.text-emerald-900= number_to_currency(current_vendor.total_paid_amount)
          %i.fas.fa-check-circle.text-4xl.text-emerald-300

    / Invoices Table
    - if @invoices.any?
      .bg-white.rounded-lg.shadow.overflow-hidden
        .overflow-x-auto
          %table.min-w-full.divide-y.divide-gray-200
            %thead.bg-gray-50
              %tr
                %th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Invoice #
                %th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Date
                %th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Items
                %th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Amount
                %th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Status
                %th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Action
            %tbody.bg-white.divide-y.divide-gray-200
              - @invoices.each do |invoice|
                %tr
                  %td.px-6.py-4.whitespace-nowrap
                    %code.text-sm.font-mono.bg-gray-100.px-2.py-1.rounded= "##{invoice.id}"
                  %td.px-6.py-4.whitespace-nowrap
                    .text-sm.font-medium.text-gray-900
                      = invoice.created_at.strftime('%b %d, %Y')
                    .text-xs.text-gray-500
                      = invoice.created_at.strftime('%I:%M %p')
                  %td.px-6.py-4
                    - if invoice.invoice_items.any?
                      .text-sm.text-gray-900
                        %span.font-semibold= invoice.invoice_items.count
                        = invoice.invoice_items.count == 1 ? 'item' : 'items'
                      .text-xs.text-gray-500.mt-1
                        = truncate(invoice.invoice_items.first.description, length: 40)
                        - if invoice.invoice_items.count > 1
                          %span.text-gray-400 + #{invoice.invoice_items.count - 1} more
                    - else
                      .text-sm.text-gray-400.italic No items
                  %td.px-6.py-4.whitespace-nowrap
                    .text-sm.font-bold.text-gray-900= number_to_currency(invoice.invoice_items.sum(:amount))
                  %td.px-6.py-4.whitespace-nowrap
                    - case invoice.payment_status
                    - when 'paid'
                      %span.inline-flex.items-center.px-2.5.py-0.5.rounded-full.text-xs.font-medium.bg-green-100.text-green-800
                        %i.fas.fa-check-circle.mr-1
                        Paid
                    - when 'pending'
                      %span.inline-flex.items-center.px-2.5.py-0.5.rounded-full.text-xs.font-medium.bg-yellow-100.text-yellow-800
                        %i.fas.fa-clock.mr-1
                        Pending
                    - when 'overdue'
                      %span.inline-flex.items-center.px-2.5.py-0.5.rounded-full.text-xs.font-medium.bg-red-100.text-red-800
                        %i.fas.fa-exclamation-circle.mr-1
                        Overdue
                    - when 'cancelled'
                      %span.inline-flex.items-center.px-2.5.py-0.5.rounded-full.text-xs.font-medium.bg-gray-100.text-gray-800
                        %i.fas.fa-ban.mr-1
                        Cancelled
                  %td.px-6.py-4.whitespace-nowrap.text-sm.font-medium
                    = link_to vendors_invoice_path(invoice), class: 'inline-flex items-center px-4 py-2 text-white rounded-lg transition-colors duration-200 gap-2 hover:opacity-90', style: 'background-color: #3A6363' do
                      %i.fas.fa-eye
                      %span View

    - else
      .bg-gray-50.rounded-lg.p-8.text-center
        %i.fas.fa-file-invoice.text-6xl.text-gray-300.mb-4
        %h3.text-xl.font-semibold.text-gray-700.mb-2 No Invoices Yet
        %p.text-gray-500 You don't have any invoices at the moment.

    / Back Button
    .mt-6
      = link_to vendors_dashboard_path, class: 'inline-flex items-center px-4 py-2 text-white font-medium rounded-lg transition-colors duration-200 gap-2 hover:opacity-90', style: 'background-color: #3A6363' do
        %i.fas.fa-arrow-left
        %span Back to Dashboard
