.container.mx-auto.w-50.p-6
  .bg-white.rounded-xl.shadow-lg.overflow-hidden.p-8
    .text-center.mb-8
      %i{class: 'fas fa-car text-4xl mb-4', style: 'color: #3a6363'}
      %h2.text-3xl.font-bold.text-gray-800.mb-2 Sign Up
      %p.text-gray-600 Create an account to rent your next ride

    = form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: "space-y-6" }) do |f|
      - if params[:car_id].present?
        = hidden_field_tag :car_id, params[:car_id]
      - if params[:start_date].present?
        = hidden_field_tag :start_date, params[:start_date]
      - if params[:end_date].present?
        = hidden_field_tag :end_date, params[:end_date]

      .field.space-y-2
        = f.label :first_name, class: "block text-sm font-medium text-gray-700"
        = f.text_field :first_name,
          autofocus: true,
          class: "w-full px-4 py-3 rounded-lg border border-gray-300 transition duration-200",
          placeholder: "John",
          onfocus: "this.style.borderColor='#3a6363'; this.style.boxShadow='0 0 0 3px rgba(58, 99, 99, 0.1)'",
          onblur: "this.style.borderColor='#d1d5db'; this.style.boxShadow='none'"

      .field.space-y-2
        = f.label :last_name, class: "block text-sm font-medium text-gray-700"
        = f.text_field :last_name,
          class: "w-full px-4 py-3 rounded-lg border border-gray-300 transition duration-200",
          placeholder: "Doe",
          onfocus: "this.style.borderColor='#3a6363'; this.style.boxShadow='0 0 0 3px rgba(58, 99, 99, 0.1)'",
          onblur: "this.style.borderColor='#d1d5db'; this.style.boxShadow='none'"

      .field.space-y-2
        = f.label :email, class: "block text-sm font-medium text-gray-700"
        = f.email_field :email,
          class: "w-full px-4 py-3 rounded-lg border border-gray-300 transition duration-200",
          placeholder: "your@email.com",
          onfocus: "this.style.borderColor='#3a6363'; this.style.boxShadow='0 0 0 3px rgba(58, 99, 99, 0.1)'",
          onblur: "this.style.borderColor='#d1d5db'; this.style.boxShadow='none'"

      .field.space-y-2
        = f.label :phone, class: "block text-sm font-medium text-gray-700"
        = f.text_field :phone,
          class: "w-full px-4 py-3 rounded-lg border border-gray-300 transition duration-200",
          placeholder: "+1 555 123 4567",
          onfocus: "this.style.borderColor='#3a6363'; this.style.boxShadow='0 0 0 3px rgba(58, 99, 99, 0.1)'",
          onblur: "this.style.borderColor='#d1d5db'; this.style.boxShadow='none'"

      .field.space-y-2
        = f.label :nationality, 'Are you a Resident or a Tourist?', class: "block text-sm font-medium text-gray-700"
        .flex.gap-6.items-center
          %label.flex.items-center.gap-2.cursor-pointer.text-gray-700
            = f.radio_button :nationality, 'resident', required: true, class: "form-radio h-4 w-4 border-gray-300 transition", style: "color: #3a6363; accent-color: #3a6363"
            %span Resident (UAE Resident)
          %label.flex.items-center.gap-2.cursor-pointer.text-gray-700
            = f.radio_button :nationality, 'tourist', required: true, class: "form-radio h-4 w-4 border-gray-300 transition", style: "color: #3a6363; accent-color: #3a6363"
            %span Tourist (Foreign Tourist)

      .field.space-y-2
        = f.label :password, class: "block text-sm font-medium text-gray-700"
        .relative
          = f.password_field :password,
            autocomplete: "new-password",
            class: "w-full px-4 py-3 pr-12 rounded-lg border border-gray-300 transition duration-200",
            placeholder: "••••••••",
            onfocus: "this.style.borderColor='#3a6363'; this.style.boxShadow='0 0 0 3px rgba(58, 99, 99, 0.1)'",
            onblur: "this.style.borderColor='#d1d5db'; this.style.boxShadow='none'"
          %button.absolute.right-3.top-3.text-gray-400.hover:text-gray-600.transition{type: "button", onclick: "togglePassword(this)"}
            %i.fas.fa-eye

      .field.space-y-2
        = f.label :password_confirmation, class: "block text-sm font-medium text-gray-700"
        = f.password_field :password_confirmation,
          class: "w-full px-4 py-3 rounded-lg border border-gray-300 transition duration-200",
          placeholder: "Confirm password",
          onfocus: "this.style.borderColor='#3a6363'; this.style.boxShadow='0 0 0 3px rgba(58, 99, 99, 0.1)'",
          onblur: "this.style.borderColor='#d1d5db'; this.style.boxShadow='none'"

      .field.flex.items-center
        = f.check_box :terms_accepted, required: true, class: "h-4 w-4 border-gray-300 rounded transition", style: "color: #3a6363; accent-color: #3a6363"
        = f.label :terms_accepted, class: "ml-2 block text-sm text-gray-700" do
          | I agree to the
          %a.font-medium.transition-colors.hover:underline{href: "#", onclick: "openTermsModal()", tabindex: 0, role: "button", style: "color: #3a6363"} Terms & Conditions

      .actions
        = f.submit "Create Account",
          class: "w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white transition duration-200 hover:shadow-md",
          style: "background-color: #3a6363; hover:background-color: #2d4d4d"

    .mt-6.text-center
      Already have an account?
      - login_url = new_session_path(resource_name)
      - if params[:car_id].present? || params[:start_date].present? || params[:end_date].present?
        - login_url += "?#{request.query_string}"
      = link_to "Log in", login_url, class: "font-medium hover:underline transition-colors", style: "color: #3a6363"

    - if alert
      .mt-4.p-3.bg-red-50.text-red-700.rounded-lg.text-sm.border.border-red-200= alert
    - if notice
      .mt-4.p-3.text-green-700.rounded-lg.text-sm.border{style: 'background-color: #f0f9f0; border-color: #3a6363'}= notice

  / Terms & Conditions Modal
  #terms-modal.fixed.inset-0.z-50.flex.items-center.justify-center.bg-black.bg-opacity-40{style: "display:none"}
    .bg-white.rounded-lg.shadow-lg.max-w-lg.w-full.p-6.relative.flex.flex-col
      %h3.text-xl.font-bold.mb-4.text-gray-800 Terms & Conditions
      .overflow-y-auto.max-h-64.mb-6.pr-2
        %p.text-gray-700.mb-2
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod, urna eu tincidunt consectetur, nisi nisl aliquam nunc, eget aliquam massa nisl quis neque. Etiam euismod, urna eu tincidunt consectetur, nisi nisl aliquam nunc, eget aliquam massa nisl quis neque.
        %p.text-gray-700.mb-2
          Mauris non tempor quam, et lacinia sapien. Mauris accumsan eros eget libero posuere vulputate. Etiam elit elit, elementum sed varius at, adipiscing vitae est. Sed nec felis pellentesque, lacinia dui sed, ultricies sapien.
        %p.text-gray-700.mb-2
          Mauris non tempor quam, et lacinia sapien. Mauris accumsan eros eget libero posuere vulputate. Etiam elit elit, elementum sed varius at, adipiscing vitae est. Sed nec felis pellentesque, lacinia dui sed, ultricies sapien.
        %p.text-gray-700.mb-2
          Sed nec felis pellentesque, lacinia dui sed, ultricies sapien. Nullam in magna eget dolor cursus bibendum. Proin viverra, nunc eget cursus bibendum, nunc eget cursus bibendum, nunc eget cursus bibendum.
      %button.mt-auto.text-white.font-semibold.py-2.px-6.rounded-lg.shadow-md.transition.duration-200.hover:shadow-lg{type: "button", onclick: "closeTermsModal()", style: "background-color: #3a6363; hover:background-color: #2d4d4d"} Done
    %button.absolute.top-2.right-2.text-gray-400.hover:text-gray-600.text-2xl.font-bold.bg-transparent.border-0.transition{type: "button", onclick: "closeTermsModal()"} ×

:javascript
  function togglePassword(button) {
    const input = button.previousElementSibling
    const icon = button.querySelector('i')
    if (input.type === 'password') {
      input.type = 'text'
      icon.classList.replace('fa-eye', 'fa-eye-slash')
    } else {
      input.type = 'password'
      icon.classList.replace('fa-eye-slash', 'fa-eye')
    }
  }

  function openTermsModal() {
    document.getElementById('terms-modal').style.display = 'flex';
  }
  
  function closeTermsModal() {
    document.getElementById('terms-modal').style.display = 'none';
  }

  // Enhanced styling for form elements
  document.addEventListener('DOMContentLoaded', function() {
    // Style radio buttons and checkbox with the theme color
    const radioButtons = document.querySelectorAll('input[type="radio"]');
    const checkbox = document.querySelector('input[type="checkbox"]');
    
    radioButtons.forEach(radio => {
      radio.style.accentColor = '#3a6363';
    });
    
    if (checkbox) {
      checkbox.style.accentColor = '#3a6363';
    }
  });